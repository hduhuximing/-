## 周报【2020.06.28-2020.07.1】

**上周工作主要内容**

1. 后台banner的bug修复，对自动过期的数据未做处理。解决方法是在每次调用上下线列表查询以及更新是进行过期数据的移动判断。 
2. 技术中心前台-首页分类视图，根据场景分类以及wikiid查询分类视图信息，并且在返回值中如果当前是分类需要将分类下的所有词条以及分类的数量统计出来返回给前端，采用递归查询的方式将获取到当前阶段的资源信息，并根据当前的wikiId进行遍历查询，并记录数量。
3.  技术中心前台-场景文档侧边栏全量加载，根据文档类型以及阶段查询数据，采用数据库一次查询，在内存中构建一个VO对象其中主要包含ChildList，通过该字段递归构建树形结构。
4. 技术中心前台-产品文档侧边侧边栏全量加载，产品文档传入产品id以及文档类型id进行区分，构建树形结构采用与场景文档的相同方法。
5. 上述产品文档与场景文档的侧边栏整合为同一个接口，根据传入的文档类型进行区分
6. 技术中心前台-首页产品文档中心，一次性全量查询产品文档，不需要前端参数。一次性将数据查询到内存中，封装VO对象中应用list直接在内存中构建产品分类-下属产品列表的返回值。
7. 技术中心前台-首页产品关联场景 ，根据产品id搜索关联的场景并以列表形式返回。
8. 接口自测调试
9. PM知识地图显示负数bug修复，将减分操作放在当时加分的月份
10. 为了不影响当前部署的PM，对后台返回贡献值的sql进行过滤操作，只返大于0的数据。

**工作收获**

1. 技术中心前台接口自测阶段完成，部分接口已经与前端对接完成。
2. RestFUL风格接口规范的重新认识

**存在问题及改进计划**

1. 树形结构的返回形式，之前想采用每次查询当前分类下属一级分类，这种形式在层次过多的时候会产生大量的mysql连接请求，性能低。采用全量加载，在内存中将数据构造成树形结构。
2. 之前的banner中自动过期的数据要求在下线列表的首位，需要获取到上线列表的最后一个。这里采用两次遍历的形式，第一次遍历出当前上线的banner个数作为count，第二次通过num记录banner上线数，当num==count说明当前是最后一个上线的。此时就找到了下线的第一个位置。在遍历的过程中将下线的数据用list存储。在找到位置后进行下线操作。

**下周工作计划**

1. splendor 接口（李冰）
2. 技术中心测试跟进、bug修复 
3. PM专区-增加最近浏览 12h
4. PM专区-管理后台增加专题推荐管理 

**游戏体验**

1. 荒野乱斗